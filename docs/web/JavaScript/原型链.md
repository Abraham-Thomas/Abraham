# 原型链

**创建对象有几种方法？**

字面量(new Object()可以归为字面量，也可归于构造函数）、构造函数、Object.create()——它创建的对象是用原型链来连接的。

**原型、构造函数、实例、原型链**

构造函数使用new运算符生成一个实例，构造函数也是函数，函数都有一个prototype属性，也就是原型对象。原型对象中会有一个构造器属性constructor，默认指向构造函数，每个实例都有\__proto__，它指向构造函数的原型对象。

Object.prototype是整个原型链的顶端，任何一个实例对象通过原型链（prototype对象属性和\__proto__属性）找到上一级的原型对象，里面的方法和属性都是被共享的，这就是原型链的基本原理。

只有函数才有prototype，对象没有。

只有实例对象有\__proto__，函数也是对象。它的这个属性===Function.prototype。

**instanceof原理**

实例对象的\__proto__引用的是构造函数的原型对象，它判断的原理就是和构造函数的prototype是不是同一个引用。只要是在原型链上的，它们可能都是指向同一个。

用constructor判断可能会更为严谨。

**new运算符**

1、一个新对象被创建，它继承自foo.prototype，

2、构造函数foo被执行，执行的时候，相应的传参会被传入，同时上下文（this）会被指定为这个新实例。new foo等同于new foo()，只能用在不传递任何参数的情况。

3、如果构造函数返回一个对象，那么这个对象会取代整个new出来的结果。如果构造函数没有返回对象，那么new出来的结果为步骤1创建的对象。

```
var new2 = function(func){
	//创建空对象，关联构造函数的原型对象
    var o = Object.create(func.prototype);
    //执行构造函数
    var k = func.call(o);
    //判断构造函数的运行结果
    if(typeof k === 'object'){
        return k;
    } else {
        return o;
    }
}
```

